
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation pour construire un homelab s√©curis√© et complet">
      
      
        <meta name="author" content="krhsaay">
      
      
      
        <link rel="prev" href="../stockage/">
      
      
        <link rel="next" href="../lxc-vs-vm/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>R√©seau & VLANs - Homelab Doc</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#plan-de-reseau-homelab-vlan-segmentation-et-passerelles" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-t√™te">
    <a href="../.." title="Homelab Doc" class="md-header__button md-logo" aria-label="Homelab Doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Homelab Doc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              R√©seau & VLANs
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Homelab Doc" class="md-nav__button md-logo" aria-label="Homelab Doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Homelab Doc
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accueil
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üèó Infrastructure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üèó Infrastructure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proxmox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proxmox VE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stockage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stockage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    R√©seau & VLANs
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    R√©seau & VLANs
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des mati√®res">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des mati√®res
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-pourquoi-segmenter-son-reseau" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction : Pourquoi segmenter son r√©seau ?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topologie-generale-et-materiel-requis" class="md-nav__link">
    <span class="md-ellipsis">
      Topologie g√©n√©rale et mat√©riel requis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-des-vlan-sur-le-pare-feu-opnsensepfsense" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration des VLAN sur le pare-feu (OPNsense/pfSense)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notions-avancees-et-meilleures-pratiques" class="md-nav__link">
    <span class="md-ellipsis">
      Notions avanc√©es et meilleures pratiques
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Notions avanc√©es et meilleures pratiques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vlan-tagges-vs-non-tagges-trunkaccess" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN tagg√©s vs non tagg√©s (trunk/access)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acl-et-controle-de-trafic-intra-vlan-ou-sur-switch" class="md-nav__link">
    <span class="md-ellipsis">
      ACL et contr√¥le de trafic intra-VLAN ou sur switch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#igmp-snooping-et-trafic-multicast" class="md-nav__link">
    <span class="md-ellipsis">
      IGMP Snooping et trafic multicast
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pare-feu-inter-vlan-vs-intra-vlan" class="md-nav__link">
    <span class="md-ellipsis">
      Pare-feu inter-VLAN vs intra-VLAN
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#segmentation-par-zone-vlan-proposes-pour-le-homelab" class="md-nav__link">
    <span class="md-ellipsis">
      Segmentation par zone : VLAN propos√©s pour le homelab
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Segmentation par zone : VLAN propos√©s pour le homelab">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vlan" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#production" class="md-nav__link">
    <span class="md-ellipsis">
      Production
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lan-principal-personnel" class="md-nav__link">
    <span class="md-ellipsis">
      (LAN principal personnel)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vlan_1" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-securite" class="md-nav__link">
    <span class="md-ellipsis">
      Lab S√©curit√©
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#red-team-blue-team" class="md-nav__link">
    <span class="md-ellipsis">
      (Red Team / Blue Team)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vlan_2" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#domotiqueiot" class="md-nav__link">
    <span class="md-ellipsis">
      Domotique/IoT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vlan_3" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cameras-ip" class="md-nav__link">
    <span class="md-ellipsis">
      Cam√©ras IP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#surveillance-cctv" class="md-nav__link">
    <span class="md-ellipsis">
      (Surveillance CCTV)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vlan_4" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stockage-iscsi" class="md-nav__link">
    <span class="md-ellipsis">
      Stockage (iSCSI)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vlan_5" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sauvegardes" class="md-nav__link">
    <span class="md-ellipsis">
      Sauvegardes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backup" class="md-nav__link">
    <span class="md-ellipsis">
      (Backup)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vlan_6" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#management" class="md-nav__link">
    <span class="md-ellipsis">
      Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#oob-admin" class="md-nav__link">
    <span class="md-ellipsis">
      (OOB, admin)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vlan_7" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dmz" class="md-nav__link">
    <span class="md-ellipsis">
      DMZ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zone-demilitarisee" class="md-nav__link">
    <span class="md-ellipsis">
      (zone d√©militaris√©e)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vlan_8" class="md-nav__link">
    <span class="md-ellipsis">
      VLAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invites" class="md-nav__link">
    <span class="md-ellipsis">
      Invit√©s
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guest-wi-fi" class="md-nav__link">
    <span class="md-ellipsis">
      (Guest Wi-Fi)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion-vers-un-homelab-segmente-securise-et-evolutif" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion : Vers un homelab segment√©, s√©curis√© et √©volutif
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lxc-vs-vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LXC vs VM
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üåê R√©seau
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üåê R√©seau
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reseau/dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dashboards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reseau/dns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DNS (Pi-hole, AdGuard...)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reseau/vpn-remote-access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acc√®s VPN distant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reseau/reverse-proxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reverse Proxy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reseau/ddns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DNS Dynamique (DDNS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reseau/torrent-vpn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VPN et torrents
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üß∞ Outils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            üß∞ Outils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outils/gestion-fichiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gestion de fichiers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outils/gestion-mots-de-passe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mots de passe (Vaultwarden...)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outils/favoris/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Favoris et veille (Hoarder)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outils/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker & Portainer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üì∫ M√©dia
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üì∫ M√©dia
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../media/streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Streaming (Jellyfin, Plex)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../media/overseerr-sonarr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sonarr, Overseerr
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../media/clients-download.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    T√©l√©chargements (qBittorrent)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../media/photos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Photos (Immich)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üè† Domotique
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üè† Domotique
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domotique/homeassistant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home Assistant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domotique/zigbee/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zigbee2MQTT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../domotique/surveillance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vid√©osurveillance (Frigate)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üìä Monitoring
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            üìä Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/grafana/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grafana
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/prometheus-influx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prometheus / InfluxDB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/netalert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NetAlertX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üîê S√©curit√©
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            üîê S√©curit√©
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../securite/vaultwarden/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vaultwarden
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../securite/authentification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authentification MFA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../securite/siem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SIEM (Wazuh, ELK...)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../securite/segmentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Segmentation & honeypots
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    üß™ DIY
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            üß™ DIY
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../diy/esp32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ESP32 & capteurs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../diy/octoprint.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OctoPrint & impression 3D
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../diy/n8n.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    N8N Automatisation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="plan-de-reseau-homelab-vlan-segmentation-et-passerelles"><strong>Plan de r√©seau Homelab : VLAN, Segmentation et Passerelles</strong><a class="headerlink" href="#plan-de-reseau-homelab-vlan-segmentation-et-passerelles" title="Permanent link">&para;</a></h1>
<h2 id="introduction-pourquoi-segmenter-son-reseau"><strong>Introduction : Pourquoi segmenter son r√©seau ?</strong><a class="headerlink" href="#introduction-pourquoi-segmenter-son-reseau" title="Permanent link">&para;</a></h2>
<p>Segmenter un r√©seau domestique en  <strong>VLAN</strong>  (Virtual LAN) consiste √† cr√©er des sous-r√©seaux logiques isol√©s les uns des autres, m√™me s‚Äôils partagent le m√™me mat√©riel physique (commutateurs, points d‚Äôacc√®s, etc.). Cette isolation pr√©sente de nombreux avantages : am√©lioration de la  <strong>s√©curit√©</strong>  (limiter qu‚Äôun appareil compromis n‚Äôaffecte les autres), meilleure  <strong>ma√Ætrise du trafic</strong>  avec des  <strong>r√®gles firewall</strong>  plus fines, r√©duction du  <strong>broadcast</strong>  inutile, etc.  . Dans un homelab o√π coexistent divers √©quipements (serveurs de production personnelle, √©quipements domotiques, cam√©ras IP, labos de cybers√©curit√©, NAS de sauvegarde, etc.), les VLAN permettent de  <strong>‚Äúcloisonner‚Äù chaque cat√©gorie d‚Äô√©quipements</strong>  dans son propre r√©seau √©tanche. Par exemple, les appareils IoT (domotique) souvent peu s√©curis√©s ne pourront pas acc√©der √† vos PC personnels sensibles  , et vos exp√©rimentations en lab s√©curit√© ne risqueront pas de perturber votre r√©seau principal.</p>
<p>En bref, un VLAN est un  <strong>segment de r√©seau isol√©</strong>. Les appareils au sein d‚Äôun m√™me VLAN communiquent librement (comme s‚Äôils √©taient sur un m√™me switch), mais ne ‚Äúvoient‚Äù pas ceux des autres VLAN sans passer par un routeur/pare-feu qui fait respecter des r√®gles d‚Äôacc√®s  . Cette isolation par VLAN est un  <strong>principe cl√© de la d√©fense en profondeur</strong>  en r√©seau domestique : on limite drastiquement les communications non n√©cessaires entre les diff√©rentes  <strong>zones de confiance</strong>du homelab.</p>
<h2 id="topologie-generale-et-materiel-requis"><strong>Topologie g√©n√©rale et mat√©riel requis</strong><a class="headerlink" href="#topologie-generale-et-materiel-requis" title="Permanent link">&para;</a></h2>
<p>Pour mettre en place des VLAN chez soi, il faut du mat√©riel r√©seau prenant en charge 802.1Q (standard des VLAN). En pratique, il vous faudra :</p>
<ul>
<li>
<p><strong>Un routeur/pare-feu</strong>  central capable de g√©rer des interfaces VLAN et de filtrer le trafic entre elles (par exemple un PC ou appliance avec OPNsense ou pfSense). Ces syst√®mes supportent nativement les VLAN 802.1Q et le firewall √† √©tats, ce qui est id√©al pour impl√©menter la segmentation  .</p>
</li>
<li>
<p><strong>Un commutateur manageable</strong>  (switch g√©r√©) qui supporte la configuration de VLAN. C‚Äôest indispensable pour brancher plusieurs appareils en isolant leurs ports par VLAN, surtout si le routeur n‚Äôa que peu de ports physiques  . Le switch fera transiter les trames VLAN ‚Äútagg√©es‚Äù entre le routeur et les √©quipements.</p>
</li>
<li>
<p>(Optionnel)  <strong>Des points d‚Äôacc√®s Wi-Fi compatibles VLAN</strong>, si vous souhaitez avoir des SSID Wi-Fi distincts pour diff√©rentes VLAN (ex : un SSID pour le r√©seau principal, un pour les invit√©s, un pour l‚ÄôIoT‚Ä¶). De nombreux AP prosumer (Unifi, Omada, OpenWrt, etc.) permettent d‚Äôassocier chaque SSID √† un VLAN ID sp√©cifique.</p>
</li>
</ul>
<p>La topologie typique dans un homelab VLAN est la suivante :  <strong>le routeur/pare-feu est reli√© en tronc (trunk) au switch principal</strong>  via un lien Ethernet sur lequel  <em>tous</em>  les VLAN sont autoris√©s (trame 802.1Q tagg√©es)  . Le routeur agit comme  <strong>passerelle par d√©faut</strong>  pour chaque VLAN (il a une interface virtuelle dans chacun, avec une IP de gateway). Le switch, lui, connecte les diff√©rents appareils et applique l‚Äô<strong>appartenance VLAN</strong>  sur chaque port. Les ports du switch reli√©s √† des appareils ordinaires (PC, cam√©ras, etc.) sont configur√©s en  <strong>VLAN ‚Äúuntagged‚Äù</strong>  d‚Äôun VLAN sp√©cifique (on parle de port access non tagg√©) ‚Äì le p√©riph√©rique n‚Äôa pas conscience du VLAN, il re√ßoit juste du trafic de son sous-r√©seau  . En revanche, le port du switch reli√© au routeur est configur√© en  <strong>trunk tagg√©</strong>  pour  <em>tous</em>  les VLAN : il transporte les trames avec leur identifiant VLAN jusqu‚Äôau routeur, qui peut ainsi router/filtrer entre VLAN  . De m√™me, un port vers un point d‚Äôacc√®s Wi-Fi multi-SSID sera souvent un trunk tagg√© transportant les VLAN des diff√©rents SSID vers l‚ÄôAP.
<em>Exemple de topologie r√©seau Homelab avec VLAN multiples (r√©seau management, primaire, IoT, invit√©s, etc.) et un routeur OPNsense interconnect√© en trunk au switch principal.</em></p>
<p>Sur le sch√©ma ci-dessus (inspir√© d‚Äôun cas r√©el), on distingue plusieurs VLAN isol√©s : un VLAN  <strong>MGMT</strong>  pour la gestion, un VLAN  <strong>Primary</strong>  (r√©seau principal), un VLAN  <strong>IoT</strong>  pour les objets connect√©s, un VLAN  <strong>Guests</strong>  pour les invit√©s, etc., chacun avec son plan d‚Äôadressage IP d√©di√©  . Le routeur OPNsense (en haut) est la passerelle reliant ces VLAN et appliquant des r√®gles de pare-feu entre eux. Le switch (TP-Link) a des ports assign√©s √† chaque VLAN (soit en untagged pour des √©quipements sp√©cifiques, soit en trunk vers le routeur et les points d‚Äôacc√®s). Par exemple, un  <strong>NAS ou serveur</strong>peut √™tre connect√© √† un port du switch configur√© en VLAN ‚ÄúServices‚Äù, tandis qu‚Äôune  <strong>cam√©ra IP</strong>  sera sur un port attribu√© au VLAN ‚ÄúCCTV‚Äù. Le lien entre le routeur et le switch transporte tous les VLAN tagg√©s, permettant au routeur de voir chaque sous-r√©seau. Avec cette architecture, chaque cat√©gorie d‚Äô√©quipements communique principalement avec le routeur, qui d√©cide si telle VLAN a le droit de joindre telle autre ou d‚Äôacc√©der √† Internet, selon des r√®gles pr√©d√©finies.</p>
<h2 id="configuration-des-vlan-sur-le-pare-feu-opnsensepfsense"><strong>Configuration des VLAN sur le pare-feu (OPNsense/pfSense)</strong><a class="headerlink" href="#configuration-des-vlan-sur-le-pare-feu-opnsensepfsense" title="Permanent link">&para;</a></h2>
<p>La mise en place concr√®te des VLAN dans OPNsense/pfSense se fait en plusieurs √©tapes. Voici un guide pas-√†-pas synth√©tique :</p>
<ol>
<li>
<p><strong>D√©finir les VLAN dans le routeur</strong> : Sur OPNsense/pfSense, commencez par cr√©er les VLAN (menu Interfaces &gt; Other &gt; VLANs). Pour chaque VLAN, on sp√©cifie un identifiant num√©rique (VID, entre 1 et 4094) et l‚Äôinterface physique parent (par ex. votre port LAN connect√© au switch)  . Exemple : VLAN 10 ‚ÄúProd‚Äù, VLAN 20 ‚ÄúLab‚Äù, VLAN 30 ‚ÄúDomotique‚Äù, etc.  Veillez √† choisir des IDs coh√©rents et uniques. Une bonne pratique est de faire correspondre le num√©ro du VLAN avec le troisi√®me octet de son r√©seau IP (ex: VLAN 10 ‚Üí 192.168.<strong>10</strong>.0/24)  , afin de s‚Äôy retrouver facilement.</p>
</li>
<li>
<p><strong>Assigner les interfaces</strong> : Une fois VLANs d√©finis, il faut les associer √† des interfaces logiques dans le pare-feu. Dans pfSense/OPNsense, on va dans  <em>Interfaces &gt; Assignments</em>  et on ajoute chaque VLAN comme nouvelle interface. Donnez-leur un nom significatif (LAN_PROD, LAN_IoT, etc.), puis activez-les. Assignez une  <strong>plage d‚Äôadresses IP</strong>  √† chaque interface VLAN (typiquement /24). Par exemple : VLAN 10 (Prod) pourrait avoir 192.168.10.1/24 comme IP de gateway (le routeur se positionne sur .1), VLAN 20 (Lab) en 192.168.20.1/24, etc. Chaque VLAN est ainsi un sous-r√©seau IP distinct avec sa passerelle  .</p>
</li>
<li>
<p><strong>DHCP et DNS</strong> : Configurez un serveur  <strong>DHCP</strong>  sur chaque interface VLAN pour distribuer automatiquement les IP aux h√¥tes de ce r√©seau. Sur OPNsense/pfSense, on peut copier la config DHCP du LAN principal puis ajuster la plage. De m√™me, vous pouvez activer le service DNS (Unbound) pour qu‚Äôil √©coute sur tous les VLAN, afin que les clients utilisent le routeur comme r√©solveur DNS. Attention toutefois : pensez √† autoriser le trafic DNS vers le routeur sur chaque VLAN (voir r√®gles plus bas).</p>
</li>
<li>
<p><strong>Configuration du switch</strong> : Du c√¥t√© du commutateur manageable, cr√©ez les VLAN avec les m√™mes IDs. Ensuite, attribuez chaque  <strong>port du switch</strong>  au VLAN appropri√©.</p>
<ul>
<li>
<p>Le port reli√© au routeur doit √™tre configur√© en  <strong>trunk/tagg√© sur tous les VLAN</strong>  (ou au moins sur tous ceux utilis√©s). Ainsi, les trames sortant du routeur avec un tag VLAN seront accept√©es et propag√©es sur le switch  .</p>
</li>
<li>
<p>Les ports reli√©s √† des dispositifs finaux (PC, cam√©ra, IoT, etc.) seront mis en mode  <strong>access (non tagg√©)</strong>  dans le VLAN correspondant √† cet appareil. Par exemple, si un PC principal doit √™tre dans le VLAN Prod (10), on met son port en VLAN 10 untagged (et aucun autre VLAN sur ce port). De cette mani√®re, le switch ajoutera/retirera le tag VLAN automatiquement pour ce port, et le PC n‚Äôaura aucune configuration sp√©ciale √† conna√Ætre  .</p>
</li>
<li>
<p>Si un port du switch est connect√© √† un point d‚Äôacc√®s Wi-Fi multi-SSID ou √† un hyperviseur accueillant plusieurs VLAN, ce port devra √™tre configur√© en  <strong>tagg√© (trunk)</strong>  pour les VLAN n√©cessaires (ex: tagg√© VLAN 10,20,30 sur le port d‚Äôun AP qui diffuse trois SSID isol√©s)  .</p>
</li>
<li>
<p>Pour les  <strong>ports inutilis√©s</strong>  sur le switch, par mesure de s√©curit√©, vous pouvez les d√©sactiver ou les assigner √† un VLAN ‚Äúpoubelle‚Äù non rout√© (ex: VLAN 999) pour √©viter qu‚Äôun appareil non autoris√© ne se connecte √† votre insu  .</p>
</li>
</ul>
</li>
<li>
<p><strong>R√®gles de firewall inter-VLAN</strong> : Par d√©faut, sur pfSense/OPNsense, chaque interface VLAN nouvellement cr√©√©e n‚Äôa  <strong>aucune r√®gle autorisant le trafic entrant</strong>, ce qui signifie qu‚Äôaucune communication  <em>depuis</em>  ce VLAN n‚Äôest permise (tout est bloqu√© par le policy  <em>default deny</em>). Il convient donc d‚Äôajouter des r√®gles pour permettre au moins l‚Äôacc√®s √† Internet depuis chaque VLAN, tout en  <strong>bloquant l‚Äôacc√®s aux autres VLAN</strong>. Une m√©thode simple consiste √† bloquer toute destination correspondant aux r√©seaux priv√©s locaux (RFC1918) pour chaque VLAN, sauf exceptions n√©cessaires  . Concr√®tement, sur l‚Äôonglet firewall de chaque VLAN :</p>
<ul>
<li>
<p>On cr√©e en haut une r√®gle autorisant le trafic de ce VLAN vers l‚ÄôIP de  <strong>passerelle du routeur</strong>  (son adresse dans ce VLAN) pour les services indispensables comme DNS ou DHCP. Par exemple, autoriser  VLAN10_net -&gt; 192.168.10.1 (port 53)  pour permettre aux clients du VLAN 10 d‚Äôinterroger le DNS du routeur  .</p>
</li>
<li>
<p>En deuxi√®me r√®gle, on ajoute un  <strong>Bloc</strong>  de tout le trafic de  VLAN10_net  vers l‚Äôalias ‚ÄúRFC1918‚Äù (regroupant les plages priv√©es 10.0.0.0/8, 192.168.0.0/16, etc.), afin d‚Äôemp√™cher ce VLAN d‚Äôatteindre  <em>tout r√©seau local interne</em>  autre que le sien  . C‚Äôest cette r√®gle qui interdit l‚Äôinter-VLAN par d√©faut.</p>
</li>
<li>
<p>En troisi√®me position (apr√®s le bloc inter-VLAN donc), on met une r√®gle  <strong>Autoriser</strong>  de  VLAN10_net  vers ‚Äú*‚Äù (any) pour permettre l‚Äôacc√®s Internet. Gr√¢ce √† l‚Äôordre, le trafic vers Internet (destinations publiques) passera, tandis que toute tentative vers IP priv√©es sera match√©e par la r√®gle de bloc au-dessus et donc interdite  .  <em>NB:</em>  si votre pare-feu a l‚Äôoption ‚ÄúBlock private networks‚Äù activ√©e sur l‚Äôinterface WAN, il filtrera d√©j√† l‚Äôentr√©e depuis internet des IP priv√©es externes, mais ici il s‚Äôagit du trafic sortant inter-LAN.</p>
</li>
</ul>
<p>Avec ce sch√©ma de r√®gles, chaque VLAN peut acc√©der au WAN mais pas aux autres LAN, sauf cas particulier. Pour ces  <strong>exceptions</strong>, on ajoutera des r√®gles sp√©cifiques  <em>au-dessus</em>  du bloc RFC1918. Par ex., si l‚Äôon veut permettre au VLAN Sauvegarde de joindre le NAS sur VLAN Prod sur le port NFS, on cr√©erait une r√®gle autorisant  Source: VLAN_Sauvegarde_net -&gt; Dest: NAS_IP (port 2049)  plac√©e avant la r√®gle de bloc g√©n√©ral. De m√™me, on peut vouloir qu‚Äôun VLAN ‚ÄúManagement‚Äù ait le droit de joindre l‚Äôinterface de gestion d‚Äô√©quipements sur d‚Äôautres VLAN ‚Äì il faut alors pr√©voir ces autorisations explicitement, ou utiliser des groupes d‚Äôinterfaces pour simplifier (pfsense permet de cr√©er un groupe contenant toutes les interfaces internes et d√©finir une r√®gle une fois)  .</p>
</li>
<li>
<p><strong>V√©rifications</strong> : Une fois la configuration appliqu√©e, connectez des appareils dans chaque VLAN et testez : chaque VLAN doit obtenir des IP correctes via DHCP, avoir acc√®s √† Internet si pr√©vu, et  <em>ne pas</em>  pouvoir atteindre les machines des autres VLAN (par ex., un PC en VLAN 10 ne doit pas ping un PC en VLAN 20). Testez √©galement les cas autoris√©s (ping de la passerelle, r√©solution DNS, etc.). Ajustez les r√®gles firewall si n√©cessaire en cas de service l√©gitime bloqu√© (ex: autoriser le VLAN IoT √† contacter un serveur domotique sur VLAN Prod, mais uniquement sur le port de l‚ÄôAPI requis).</p>
</li>
</ol>
<p>En r√©sum√©, le routeur/pare-feu multi-VLAN joue le r√¥le de  <strong>passerelle et filtre</strong>  entre les segments. Le switch assure que la s√©paration niveau 2 est respect√©e (pas de fuite de trames entre VLAN), et le routeur contr√¥le au niveau 3 ce qui est autoris√© ou non entre les VLAN.</p>
<h2 id="notions-avancees-et-meilleures-pratiques"><strong>Notions avanc√©es et meilleures pratiques</strong><a class="headerlink" href="#notions-avancees-et-meilleures-pratiques" title="Permanent link">&para;</a></h2>
<p>Dans un homelab bien segment√©, certaines notions plus pointues peuvent entrer en jeu pour optimiser le fonctionnement ou la s√©curit√© :</p>
<h3 id="vlan-tagges-vs-non-tagges-trunkaccess"><strong>VLAN tagg√©s vs non tagg√©s (trunk/access)</strong><a class="headerlink" href="#vlan-tagges-vs-non-tagges-trunkaccess" title="Permanent link">&para;</a></h3>
<p>Il est crucial de bien comprendre la diff√©rence entre un port  <strong>tagg√© (trunk)</strong>  et  <strong>non tagg√© (access)</strong>  sur le switch. Un port  <em>untagged</em>  dans un VLAN signifie que le p√©riph√©rique connect√© n‚Äôenvoie ni ne re√ßoit de trames VLAN marqu√©es ‚Äì le switch int√®gre l‚Äôappareil dans le VLAN en interne, en ajoutant/retirant le tag 802.1Q lui-m√™me. Ce mode est destin√© aux √©quipements ‚Äúnormaux‚Äù (PC, imprimante, cam√©ra, etc.) qui ne connaissent pas les VLAN  . En revanche, un port  <em>tagged trunk</em>  transporte les trames avec leurs identifiants VLAN inchang√©s. Il sert pour relier deux √©quipements VLAN-aware : par exemple la liaison entre le routeur et le switch, ou entre deux switches, ou vers un AP multi-SSID. Ces √©quipements comprennent les tags et peuvent appartenir √† plusieurs VLAN simultan√©ment.  <strong>R√®gle d‚Äôor</strong> : un port trunk peut v√©hiculer plusieurs VLAN (tagg√©s), un port access ne doit appartenir qu‚Äô√† un seul VLAN et pr√©sente ce VLAN en ‚Äúnon tagg√©‚Äù au device connect√©.</p>
<p>Dans la configuration, veillez √†  <strong>coh√©rer les tags</strong>  de bout en bout : si le VLAN 20 est utilis√© pour la domotique, le routeur taggue ce trafic VLAN20 sur l‚Äôinterface trunk, le switch doit avoir VLAN20 activ√© sur le port trunk et les ports des objets domotiques en VLAN20 untagged. Une erreur de tag (ex: VLAN ID mismatch) se traduit par un appareil incapable de communiquer au-del√† de son switch.</p>
<h3 id="acl-et-controle-de-trafic-intra-vlan-ou-sur-switch"><strong>ACL et contr√¥le de trafic intra-VLAN ou sur switch</strong><a class="headerlink" href="#acl-et-controle-de-trafic-intra-vlan-ou-sur-switch" title="Permanent link">&para;</a></h3>
<p>En environnement professionnel, on utilise parfois des  <strong>ACL (Access Control Lists)</strong>  sur les commutateurs de niveau 3 ou m√™me niveau 2 pour filtrer le trafic  <em>au sein</em>  du r√©seau, ind√©pendamment du pare-feu central. Dans un homelab, si vous disposez d‚Äôun switch L3 avanc√©, vous pourriez mettre en ≈ìuvre des ACL pour bloquer certaines communications inter-VLAN directement au niveau du switch, en compl√©ment ou √† la place des r√®gles du routeur. Cependant, dans la plupart des cas, votre pare-feu OPNsense/pfSense remplit d√©j√† ce r√¥le (ses r√®gles agissent en fait comme des ACL de niveau 3/4). L‚Äôutilisation d‚ÄôACL sur le switch peut √™tre utile si vous faites du routage local sur un switch L3 pour d√©charger le routeur (cependant, ceci est rarement n√©cessaire √† l‚Äô√©chelle d‚Äôun homelab). Retenez qu‚ÄôACL ou firewall reviennent √† d√©finir des r√®gles : commencez simple (tout inter-VLAN bloqu√© sauf exceptions), puis affinez au besoin avec des r√®gles sp√©cifiques ou ACL pour des cas tr√®s pr√©cis. Un adepte r√©sume ainsi son approche maison : isoler les VLAN, puis  <strong>‚Äúouvrir des br√®ches avec des ACL pour des dispositifs sp√©cifiques‚Äù</strong>  selon les besoins  .</p>
<h3 id="igmp-snooping-et-trafic-multicast"><strong>IGMP Snooping et trafic multicast</strong><a class="headerlink" href="#igmp-snooping-et-trafic-multicast" title="Permanent link">&para;</a></h3>
<p>Les r√©seaux locaux modernes, surtout avec domotique, Chromecast, cam√©ras, etc., utilisent du  <strong>multicast</strong>  (mDNS, SSDP, streaming vid√©o). Par d√©faut, une trame multicast est envoy√©e en broadcast sur un VLAN, ce qui peut saturer inutilement les ports. La fonction  <strong>IGMP Snooping</strong>  des switches veille √† √©couter les abonnements IGMP des appareils pour ne forwarder le trafic multicast qu‚Äôaux ports qui en ont besoin. Il est recommand√© d‚Äôactiver l‚ÄôIGMP Snooping sur chaque VLAN concern√© afin d‚Äô<strong>√©viter la diffusion de flux multicast vers tous les ports</strong>  du VLAN  . Par exemple, sur un VLAN Cam√©ras IP avec NVR, le switch n‚Äôenverra le flux vid√©o multicast qu‚Äôau port du NVR et √©ventuellement aux quelques clients inscrits, plut√¥t qu‚Äô√† tous les dispositifs du VLAN. Attention, IGMP Snooping implique qu‚Äôil y ait un  <strong>querier IGMP</strong>  sur le r√©seau (g√©n√©ralement le routeur multicast). OPNsense/pfSense peut faire office de querier si activ√©.</p>
<p>Un autre d√©fi fr√©quent en environnement VLAN est la d√©couverte mDNS/Bonjour (pour imprimantes, Chromecasts, assistants vocaux, etc.) : par design, ces protocoles ne passent pas les fronti√®res VLAN. Deux approches : soit regrouper sur un m√™me VLAN les appareils qui doivent se d√©couvrir (solution simple mais reniant l‚Äôisolation), soit utiliser un  <strong>m√©canisme de relay/reflecteur mDNS</strong>  (par ex. le service Avahi) qui r√©p√®te certaines annonces entre VLAN choisis. OPNsense inclut un plugin ‚Äúos-avahi‚Äù qui peut √™tre configur√© pour refl√©ter mDNS entre un VLAN IoT et le VLAN principal, afin que vos Chromecast (IoT) apparaissent sur votre smartphone (LAN principal) sans ouvrir tout le trafic entre ces VLAN. Cette configuration avanc√©e am√©liore le confort d‚Äôusage tout en maintenant l‚Äôisolation du reste des communications.</p>
<h3 id="pare-feu-inter-vlan-vs-intra-vlan"><strong>Pare-feu inter-VLAN vs intra-VLAN</strong><a class="headerlink" href="#pare-feu-inter-vlan-vs-intra-vlan" title="Permanent link">&para;</a></h3>
<p>Dans notre sc√©nario, on consid√®re g√©n√©ralement que les appareils  <strong>au sein d‚Äôun m√™me VLAN</strong>  sont de confiance similaire, donc on ne filtre pas leur communication mutuelle (ils peuvent dialoguer librement dans le VLAN). Si ce n‚Äôest pas souhait√© (ex: VLAN Invit√©s o√π m√™me les clients ne doivent pas se voir), on parle d‚Äô<strong>isolation client</strong>  au niveau 2 : certaines bornes Wi-Fi permettent d‚Äôisoler les clients entre eux, ou on peut utiliser des fonctionnalit√©s de switch (PVLAN, port isolation) pour emp√™cher des ports du m√™me VLAN de communiquer directement. C‚Äôest utile surtout pour un VLAN invit√© ou public. Dans la plupart des VLAN priv√©s (Prod, IoT‚Ä¶), laisser les appareils se voir peut √™tre n√©cessaire (ex: votre smartphone pilote une ampoule sur VLAN IoT ‚Äì ils doivent pouvoir communiquer  <em>si</em>  dans le m√™me VLAN IoT). Retenez donc : on cloisonne fortement  <em>entre</em>  VLAN diff√©rents (firewall L3), et on peut √©ventuellement cloisonner  <em>√† l‚Äôint√©rieur</em>  d‚Äôun m√™me VLAN (isolation L2) selon les cas d‚Äôusage sp√©cifiques.</p>
<h2 id="segmentation-par-zone-vlan-proposes-pour-le-homelab"><strong>Segmentation par zone : VLAN propos√©s pour le homelab</strong><a class="headerlink" href="#segmentation-par-zone-vlan-proposes-pour-le-homelab" title="Permanent link">&para;</a></h2>
<p>Passons en revue les diff√©rentes  <strong>zones VLAN</strong>  qu‚Äôon peut mettre en place dans un homelab bien organis√©, en fonction des besoins √©voqu√©s (production personnelle, s√©curit√©, domotique, stockage, etc.). Chaque VLAN correspond √† un  <strong>cas d‚Äôusage</strong>  et aura ses propres r√®gles de trafic.</p>
<h3 id="vlan"><strong>VLAN</strong><a class="headerlink" href="#vlan" title="Permanent link">&para;</a></h3>
<h3 id="production"><strong>Production</strong><a class="headerlink" href="#production" title="Permanent link">&para;</a></h3>
<h3 id="lan-principal-personnel"><strong>(LAN principal personnel)</strong><a class="headerlink" href="#lan-principal-personnel" title="Permanent link">&para;</a></h3>
<p>C‚Äôest le r√©seau principal pour vos √©quipements  <strong>de confiance</strong>  et critiques (PC personnels, laptop de travail ‚Äì sauf si politique entreprise l‚Äôinterdit, serveurs de prod auto-h√©berg√©s, etc.). Il peut s‚Äôagir du VLAN  <strong>10</strong>  par exemple, 192.168.10.0/24. Ce r√©seau a g√©n√©ralement  <strong>un acc√®s complet √† Internet</strong>  et peut, si n√©cessaire, initier des connexions vers certains services dans d‚Äôautres VLAN (ex: acc√©der au NAS de sauvegarde, consulter les flux des cam√©ras, etc.). En revanche, on bloque l‚Äôacc√®s  <em>entrant</em>  depuis les autres VLAN vers ce r√©seau pour le prot√©ger. Vous traiterez ce VLAN un peu comme un r√©seau ‚Äúinterne s√©curis√© d‚Äôentreprise‚Äù. Vous pouvez aussi y segmenter en deux VLAN distincts si vous h√©bergez des applications client/serveur sensibles : par exemple VLAN ‚ÄúProd-Serveurs‚Äù s√©par√© du VLAN ‚ÄúProd-Clients‚Äù. Mais pour un homelab, un seul VLAN prod suffit souvent, d‚Äôautant qu‚Äôil est plus ais√© de g√©rer quelques r√®gles ponctuelles √† l‚Äôint√©rieur que de multiplier les segments. Veillez simplement √†  <strong>ne pas connecter d‚Äôappareils peu fiables</strong>  (IoT, etc.) sur ce r√©seau.</p>
<h3 id="vlan_1"><strong>VLAN</strong><a class="headerlink" href="#vlan_1" title="Permanent link">&para;</a></h3>
<h3 id="lab-securite"><strong>Lab S√©curit√©</strong><a class="headerlink" href="#lab-securite" title="Permanent link">&para;</a></h3>
<h3 id="red-team-blue-team"><strong>(Red Team / Blue Team)</strong><a class="headerlink" href="#red-team-blue-team" title="Permanent link">&para;</a></h3>
<p>Pour vos besoins de labo cyber (pentest, forensic‚Ä¶), il est conseill√© de cr√©er un VLAN d√©di√©  <strong>hautement isol√©</strong>  du reste. Par exemple VLAN  <strong>40</strong>  = 192.168.40.0/24. Vous pouvez y faire tourner des VMs vuln√©rables, des attaques simul√©es, etc., sans risque pour votre LAN principal. Ce VLAN Lab peut m√™me √™tre subdivis√© en plusieurs segments selon vos sc√©narios : un VLAN  <strong>‚ÄúRed‚Äù</strong>  pour les machines d‚Äôattaque (attaquant) et un VLAN  <strong>‚ÄúBlue‚Äù</strong>  pour les cibles et la surveillance (d√©fenseur). Dans ce cas, vous pourriez introduire un  <strong>pare-feu interm√©diaire</strong>  entre Red et Blue pour reproduire un environnement d‚Äôentreprise (ou utiliser OPNsense lui-m√™me avec des r√®gles sp√©cifiques entre ces deux VLAN). Toutefois, si c‚Äôest un lab local purement pour exercice, un seul VLAN isol√© peut suffire, ou deux VLAN isol√©s de tout sauf d‚Äôune connexion contr√¥l√©e entre eux. Par d√©faut, le VLAN Lab n‚Äôa  <strong>pas acc√®s aux VLAN prod/domotique/etc.</strong>, et potentiellement m√™me  <strong>pas d‚Äôacc√®s Internet</strong>  si vous voulez tester des malwares en contenant (vous pourrez activer l‚Äôacc√®s WAN ponctuellement via une r√®gle ou via un proxy/VPN d√©di√© pour le lab). L‚Äôid√©e est de minimiser les ponts avec l‚Äôext√©rieur. Vous pourriez autoriser seulement la machine de l‚Äôanalyste (sur VLAN Prod par ex.) √† se connecter en RDP/SSH vers le VLAN Lab Blue Team pour y faire de l‚Äôinvestigation, mais rien de plus. Ce VLAN est votre bac √† sable dangereux : traitez-le comme une  <strong>DMZ locale</strong>  tr√®s verrouill√©e.</p>
<h3 id="vlan_2"><strong>VLAN</strong><a class="headerlink" href="#vlan_2" title="Permanent link">&para;</a></h3>
<h3 id="domotiqueiot"><strong>Domotique/IoT</strong><a class="headerlink" href="#domotiqueiot" title="Permanent link">&para;</a></h3>
<p>Tous les √©quipements  <strong>domotiques, IoT et multim√©dia</strong>  peu s√©curis√©s vont dans ce r√©seau isol√©. Par exemple VLAN  <strong>30</strong>  = 192.168.30.0/24. On y met les ampoules connect√©es, assistants vocaux, t√©l√©visions intelligentes, prises Wi-Fi, thermostats, etc. Ce sont typiquement des appareils qui  <strong>requi√®rent un acc√®s Internet</strong>  (pour leurs services cloud) mais n‚Äôont aucune raison de communiquer avec vos PC/serveurs personnels. On configure donc ce VLAN IoT de sorte que ses appareils puissent sortir vers Internet (HTTP, MQTT‚Ä¶ selon les besoins), mais  <strong>ne puissent pas initier de connexion vers les VLAN sensibles</strong>  (Prod, Sauvegarde‚Ä¶). Inversement, on peut autoriser quelques flux entrants ma√Ætris√©s : par exemple, votre smartphone (VLAN Prod) doit pouvoir envoyer des commandes vers l‚ÄôAPI locale d‚Äôune ampoule sur VLAN IoT. Une fa√ßon propre de faire cela est de d√©ployer un  <strong>serveur domotique central (type Home Assistant)</strong>  qui a deux interfaces r√©seau ‚Äì une dans le VLAN IoT pour parler aux objets, et une dans le VLAN Prod pour que vous puissiez le contr√¥ler. Si ce n‚Äôest pas possible, on ouvrira finement sur le firewall les acc√®s n√©cessaires (ex: autoriser IP_du_PC ‚Üí IP_ampoule port TCP sp√©cifique). Gardez ce VLAN IoT aussi ferm√© que possible, car ces appareils sont souvent les plus vuln√©rables. Il est d‚Äôusage √©galement de  <strong>refuser toute connexion sortante inutile</strong>  depuis IoT (filtrage par liste blanche de domaines via DNS ou r√®gles par IP si possible) afin d‚Äô√©viter qu‚Äôun objet bavard n‚Äôenvoie des donn√©es √† des tiers. En r√©sum√©, VLAN IoT = Internet oui, acc√®s aux autres VLAN non (sauf exceptions minimales), acc√®s entrants tr√®s limit√©s.</p>
<p>Notez enfin que les  <strong>protocoles multicast</strong>  type mDNS, SSDP sont massivement utilis√©s en IoT (pour la d√©couverte plug-and-play). Comme expliqu√©, ceux-ci ne traversent pas les VLAN, donc si par exemple votre Google Home (VLAN IoT) doit √™tre contr√¥l√© par votre t√©l√©phone (VLAN Prod), vous aurez besoin d‚Äôun m√©canisme comme Avahi (reflecteur mDNS) ou, plus simplement, placer le t√©l√©phone sur le VLAN IoT le temps de l‚Äôutilisation (moins s√©curis√©). √Ä vous de voir le bon compromis entre  <strong>confort</strong>  et  <strong>cloisonnement</strong>.</p>
<h3 id="vlan_3"><strong>VLAN</strong><a class="headerlink" href="#vlan_3" title="Permanent link">&para;</a></h3>
<h3 id="cameras-ip"><strong>Cam√©ras IP</strong><a class="headerlink" href="#cameras-ip" title="Permanent link">&para;</a></h3>
<h3 id="surveillance-cctv"><strong>(Surveillance CCTV)</strong><a class="headerlink" href="#surveillance-cctv" title="Permanent link">&para;</a></h3>
<p>Les cam√©ras de surveillance r√©seau m√©ritent souvent leur propre VLAN (par ex. VLAN  <strong>50</strong>  = 192.168.50.0/24), bien qu‚Äôon pourrait les mettre dans l‚ÄôIoT. Elles g√©n√®rent du trafic vid√©o continu et peuvent pr√©senter des vuln√©rabilit√©s s√©rieuses. Dans un homelab, on cr√©e un VLAN Cam√©ras isol√©  <strong>sans acc√®s Internet direct</strong>  (sauf si la cam√©ra a absolument besoin de NTP ou de mises √† jour par le web, mais id√©alement on √©vite les cam√©ras cloud). Ce VLAN ne doit communiquer qu‚Äôavec votre  <strong>NVR</strong>/serveur d‚Äôenregistrement vid√©o. Par exemple, autoriser les flux  <em>de</em>  cam√©ras ‚Üí vers NVR sur les ports RTSP, et peut-√™tre le NVR ‚Üí cam√©ras sur HTTP (pour les configurer). En dehors de cela, pas de passage. Ainsi, m√™me si une cam√©ra est compromise, l‚Äôattaquant ne pourra pas rebondir sur le reste de votre r√©seau. Un retour d‚Äôexp√©rience de homelab recommande que les cam√©ras n‚Äôaient  <em>aucune</em>  id√©e d‚ÄôInternet :  <em>¬´CCTV ‚Äì no access to outside world, cameras get time from internal NTP, and can send flux au NVR uniquement¬ª</em>  . C‚Äôest une sage pr√©caution. Si vous devez acc√©der √† vos cam√©ras depuis l‚Äôext√©rieur, faites-le via le NVR (qui serait lui-m√™me soit dans un VLAN DMZ, soit via VPN). Enfin, c√¥t√© performance, les cam√©ras et NVR peuvent consommer de la bande passante en continu : assurez-vous que votre switch supporte le d√©bit cumul√©, et envisagez √©ventuellement un  <strong>switch PoE d√©di√©</strong>  pour alimenter les cam√©ras, raccord√© en trunk sur le VLAN cam√©ras du switch principal.</p>
<h3 id="vlan_4"><strong>VLAN</strong><a class="headerlink" href="#vlan_4" title="Permanent link">&para;</a></h3>
<h3 id="stockage-iscsi"><strong>Stockage (iSCSI)</strong><a class="headerlink" href="#stockage-iscsi" title="Permanent link">&para;</a></h3>
<p>Pour les besoins de stockage partag√© (par exemple exposer un disque iSCSI depuis un NAS vers vos hyperviseurs Proxmox/ESXi), il est fortement recommand√© de d√©dier un VLAN sp√©cifique au  <strong>trafic de stockage</strong>. On peut le nommer VLAN  <strong>iSCSI</strong>  ou  <strong>SAN</strong>. Souvent, ce VLAN n‚Äôa m√™me  <em>pas</em>  de passerelle vers le routeur (pas rout√©) : il s‚Äôagit juste d‚Äôun r√©seau L2 isol√© entre votre NAS/stockage et vos serveurs, pour le traffic iSCSI ou NFS. Par exemple VLAN  <strong>20</strong>  = 10.0.20.0/24, sans sortie internet. On attribue des IP fixes aux interfaces SAN de chaque h√¥te et du NAS. Ce r√©seau √©tant isol√©, on √©vite toute pollution par d‚Äôautres flux, ce qui am√©liore les performances et la s√©curit√© (un client du VLAN Prod n‚Äôa aucune raison d‚Äôacc√©der directement au VLAN iSCSI). En pratique, il faut que vos serveurs et NAS aient chacun  <strong>deux interfaces r√©seau</strong>  (ou une interface VLAN tagg√©e c√¥t√© hyperviseur) : l‚Äôune pour le LAN normal, l‚Äôautre pour le VLAN stockage. Les √©changes iSCSI se font ainsi directement, sans passer par le routeur.</p>
<p>Si toutefois vous avez besoin que ce VLAN iSCSI soit rout√© (par ex. pour acc√©der √† l‚Äôinterface d‚Äôadmin du NAS depuis un PC), vous pouvez lui attribuer une interface sur OPNsense, mais dans ce cas filtrez rigoureusement l‚Äôacc√®s (ex: seul le PC admin peut joindre l‚ÄôIP de management du NAS sur ce VLAN). Beaucoup choisissent de ne  <em>pas</em>  router le VLAN SAN du tout, for√ßant l‚Äôacc√®s administrateur via un jump host sur ce VLAN ou via le LAN principal du NAS. Quoiqu‚Äôil en soit, on  <strong>n‚Äôautorise pas Internet</strong>  sur ce VLAN, il doit √™tre totalement interne. Pensez √©galement √† activer les  <strong>Jumbo Frames (MTU 9000)</strong>  sur ce VLAN si tous vos √©quipements le supportent, afin d‚Äôoptimiser le d√©bit de gros flux iSCSI/NFS (toutes les interfaces du NAS, serveurs et switch impliqu√©s doivent avoir MTU 9000). Les VLAN de stockage peuvent aussi inclure les trafics de virtualisation type vMotion, replication, etc., qui b√©n√©ficient d‚Äôun r√©seau √† part.</p>
<h3 id="vlan_5"><strong>VLAN</strong><a class="headerlink" href="#vlan_5" title="Permanent link">&para;</a></h3>
<h3 id="sauvegardes"><strong>Sauvegardes</strong><a class="headerlink" href="#sauvegardes" title="Permanent link">&para;</a></h3>
<h3 id="backup"><strong>(Backup)</strong><a class="headerlink" href="#backup" title="Permanent link">&para;</a></h3>
<p>Proche du VLAN stockage, vous pourriez d√©ployer un VLAN distinct pour la sauvegarde de vos donn√©es. Par exemple si vous avez un serveur de backup ou un NAS o√π les diff√©rentes machines viennent d√©poser leurs sauvegardes, il peut √™tre judicieux de l‚Äôisoler. Cependant, deux approches existent :</p>
<ul>
<li>
<p><strong>Approche 1</strong> : Le serveur de sauvegarde (NAS, etc.) r√©side  <em>uniquement</em>  dans ce VLAN Sauvegarde, et on autorise chaque VLAN source √† envoyer des donn√©es vers lui (sur les ports de backup) via le pare-feu. Par exemple, VLAN Prod peut joindre l‚Äôadresse du NAS (VLAN Backup) sur le port 873 (rsync) ou 443 (agent de backup), etc. Cela maintient la s√©paration, mais le trafic passe par le routeur et subit √©ventuellement son goulot d‚Äô√©tranglement.</p>
</li>
<li>
<p><strong>Approche 2</strong> : Le serveur de sauvegarde a  <strong>une interface dans chaque VLAN</strong>  qui le concerne (ou au moins dans VLAN Prod et VLAN Backup). C‚Äôest plus complexe et augmente la surface, donc on pr√©f√®re la premi√®re solution g√©n√©ralement.</p>
</li>
</ul>
<p>Un VLAN Backup d√©di√© prend son sens si les sauvegardes repr√©sentent beaucoup de trafic et qu‚Äôon peut le s√©parer physiquement/logiquement. Si vos sauvegardes se font la nuit, saturer le LAN principal n‚Äôest pas un gros probl√®me, donc un VLAN s√©par√© n‚Äôapporte pas √©norm√©ment en performance (sauf √† avoir des liens multiples). En s√©curit√© en revanche, isoler le serveur de sauvegarde sur un VLAN restreint est malin : en cas de compromission d‚Äôune machine du LAN Prod (ran√ßongiciel par ex), il lui sera plus difficile d‚Äôatteindre le NAS de sauvegarde s‚Äôil est sur un autre VLAN avec un acc√®s uniquement unidirectionnel.  <strong>Recommandation</strong> : placez votre NAS/serveur de backup dans un VLAN s√©par√© (par ex. VLAN 60 = 192.168.60.0/24), n‚Äôautorisez que le minimum (les machines sources peuvent envoyer des sauvegardes vers lui, mais lui ne peut initier de connexion vers elles), et n‚Äôautorisez pas ce VLAN vers Internet, sauf √©ventuellement pour envoyer des alertes mail de backup. Ainsi, vos backups sont conserv√©s dans une ‚Äúzone‚Äù distincte, r√©duisant les risques en cas de malware sur le LAN principal.</p>
<h3 id="vlan_6"><strong>VLAN</strong><a class="headerlink" href="#vlan_6" title="Permanent link">&para;</a></h3>
<h3 id="management"><strong>Management</strong><a class="headerlink" href="#management" title="Permanent link">&para;</a></h3>
<h3 id="oob-admin"><strong>(OOB, admin)</strong><a class="headerlink" href="#oob-admin" title="Permanent link">&para;</a></h3>
<p>Un VLAN souvent oubli√© dans les petits r√©seaux, mais tr√®s utile √† partir d‚Äôun certain niveau de complexit√©, est le VLAN  <strong>Administration</strong>. Id√©e : regrouper toutes les  <strong>interfaces de gestion</strong>  de vos √©quipements critiques (routeur, switch, NAS, hyperviseur, IPMI des serveurs‚Ä¶) sur un r√©seau √† part, accessible uniquement aux administrateurs. Par exemple VLAN  <strong>99</strong>  = 192.168.99.0/24. Vous configurez chaque √©quipement pour qu‚Äôil  <strong>n‚Äô√©coute son interface d‚Äôadministration web/SSH que sur l‚ÄôIP de ce VLAN Management</strong>. Ainsi, m√™me si un utilisateur malveillant se trouve sur le VLAN Prod, il ne pourra pas tenter d‚Äôacc√©der √† l‚Äôinterface du switch si celle-ci est sur VLAN 99 uniquement (et qu‚Äôil n‚Äôa pas acc√®s √† VLAN 99)  . C‚Äôest une mesure de s√©curit√©  <strong>suppl√©mentaire</strong> : m√™me en environnement domestique, il est int√©ressant de limiter l‚Äôacc√®s aux consoles d‚Äôadmin. Concr√®tement, il faut que  <em>vous</em>  disposiez d‚Äôun moyen d‚Äôentrer dans ce VLAN management quand besoin (par ex. votre PC admin a un port physique ou un SSID Wi-Fi d√©di√© √† ce VLAN, ou vous basculez un VLAN tagg√© sur votre PC quand n√©cessaire). Ce n‚Äôest pas toujours le plus pratique au quotidien, mais c‚Äôest proche des pratiques professionnelles. Vous pouvez simplifier en combinant le VLAN Management avec votre VLAN Prod si vous √™tes seul √† utiliser le r√©seau, mais si vous √™tes plusieurs utilisateurs non techniques chez vous, mieux vaut isoler la gestion.</p>
<p>Dans la config propos√©e plus haut (image du r√©seau), le VLAN ‚ÄúLAN‚Äù √©tait utilis√© comme r√©seau de management d√©di√©  . On y pla√ßait le switch, les AP, etc., tandis que les utilisateurs normaux √©taient sur d‚Äôautres VLAN par d√©faut  . Cette approche se traduit par  <em>0 service d‚Äôadmin</em>  accessible depuis les VLAN utilisateurs, ce qui r√©duit fortement les possibilit√©s d‚Äôattaque interne sur vos √©quipements. En homelab, VLAN 99 Management peut ne pas √™tre indispensable, mais il est bon de l‚Äôenvisager pour ‚Äúfuture-proof‚Äù votre design.</p>
<h3 id="vlan_7"><strong>VLAN</strong><a class="headerlink" href="#vlan_7" title="Permanent link">&para;</a></h3>
<h3 id="dmz"><strong>DMZ</strong><a class="headerlink" href="#dmz" title="Permanent link">&para;</a></h3>
<h3 id="zone-demilitarisee"><strong>(zone d√©militaris√©e)</strong><a class="headerlink" href="#zone-demilitarisee" title="Permanent link">&para;</a></h3>
<p>La DMZ est un VLAN particulier destin√© aux  <strong>services publics/expos√©s sur Internet</strong>. Si vous h√©bergez, par exemple, un serveur web accessible depuis l‚Äôext√©rieur, un VPN entrant, ou un reverse proxy frontal pour vos services, il est sain de le placer en DMZ. Ce VLAN DMZ (ex: VLAN 70 = 192.168.70.0/24) est isol√© du LAN : seul le routeur y acc√®de. On configure des r√®gles NAT/Port forwarding pour diriger le trafic entrant WAN ‚Üí vers l‚ÄôIP du serveur en DMZ, et on autorise le minimum de ce VLAN vers l‚Äôint√©rieur.  <strong>Id√©alement, la DMZ n‚Äôinitie aucune connexion vers vos LAN internes</strong>  (sauf peut-√™tre requ√™ter une base de donn√©es sur un VLAN sp√©cifique, mais dans homelab, on √©vite d‚Äôexposer une base interne). Un exemple concret : vous h√©bergez un  <strong>reverse proxy Nginx</strong>  pour acc√©der √† vos services maison (domotic, etc.) depuis Internet. Placez ce reverse proxy en DMZ. On ouvre depuis Internet seulement le port 443 vers lui. Dans le firewall, on peut autoriser ce reverse proxy DMZ √† contacter, disons, le serveur domotique en VLAN IoT sur le port requis, et c‚Äôest tout. Ainsi, si le proxy est compromis via le web, l‚Äôattaquant est confin√© en DMZ. Certains adoptent m√™me une  <strong>double barri√®re</strong>  en DMZ : le serveur DMZ est derri√®re le pare-feu principal ET poss√®de son propre pare-feu applicatif. Dans un homelab, ceinture et bretelles sont peut-√™tre excessives, mais l‚Äôid√©e est de ne jamais  <em>faire transiter du trafic Internet directement dans vos VLAN sensibles</em>. La DMZ agit comme tampon.</p>
<p>Un utilisateur homelab t√©moigne par exemple :  <em>¬´DMZ ‚Äì le seul VLAN acceptant des connexions externes (443), il h√©berge le reverse proxy externe et poss√®de un double firewall¬ª</em>  . Cela illustre bien que m√™me en environnement perso, on peut traiter la DMZ s√©rieusement. En pratique, pour configurer : cr√©ez le VLAN, attribuez-le √† une interface OPNsense (ex: OPT2), donnez-lui une plage IP. Reliez-y votre serveur public. Sur OPNsense, activez les r√®gles NAT voulues vers ce VLAN, et surtout  <strong>blocquez toute sortie de la DMZ vers vos LAN</strong>  par d√©faut. Autorisez uniquement ce qui est n√©cessaire (peut-√™tre la DMZ peut acc√©der √† Internet pour updates, ou joindre un DNS local). Un conseil : ne r√©utilisez pas vos machines de LAN en DMZ ; par exemple, √©vitez qu‚Äôun conteneur sur votre NAS principal soit expos√© : mieux vaut une VM d√©di√©e sur un h√¥te en DMZ. Cela √©vite qu‚Äôune compromission DMZ n‚Äôaffecte vos donn√©es.</p>
<h3 id="vlan_8"><strong>VLAN</strong><a class="headerlink" href="#vlan_8" title="Permanent link">&para;</a></h3>
<h3 id="invites"><strong>Invit√©s</strong><a class="headerlink" href="#invites" title="Permanent link">&para;</a></h3>
<h3 id="guest-wi-fi"><strong>(Guest Wi-Fi)</strong><a class="headerlink" href="#guest-wi-fi" title="Permanent link">&para;</a></h3>
<p>Enfin, souvent utile dans un foyer, un VLAN  <strong>Invit√©s</strong>  pour le Wi-Fi des visiteurs ou appareils temporaires. Par ex VLAN  <strong>80</strong>  = 192.168.80.0/24. Son objectif : fournir un acc√®s Internet basique  <strong>sans aucun acc√®s √† vos ressources internes</strong>. Ici il faut g√©n√©ralement activer l‚Äôisolement client sur l‚ÄôAP Wi-Fi (pour que les invit√©s ne se voient pas entre eux), et sur le pare-feu on bloque toute destination locale. En gros, c‚Äôest tr√®s proche du VLAN IoT en termes de r√®gles, mais on peut √™tre encore plus restrictif (pas d‚Äôacc√®s sortant vers des ports sensibles, √©ventuellement limiter la bande passante via QoS). Le VLAN Invit√©s est un bon moyen de partager votre connexion sans compromettre le reste. Avec un portail captif ou un mot de passe distinct, vous pouvez contr√¥ler l‚Äôutilisation. Techniquement, il suffit de cr√©er ce VLAN invit√©, de le lier √† un SSID d√©di√© sur votre point d‚Äôacc√®s, et de v√©rifier que les r√®gles firewall interdisent tout acc√®s aux autres VLAN (ce qui devrait d√©j√† √™tre le cas si on bloque RFC1918 en sortie).</p>
<p>Pour r√©sumer, isoler les invit√©s vous prot√®ge de tout poste non ma√Ætris√© (par exemple l‚Äôordinateur v√©rol√© d‚Äôun ami de passage ne pourra pas scanner/transmettre quoi que ce soit √† vos machines). C‚Äôest une VLAN √† consid√©rer m√™me si non mentionn√© initialement, puisque  <strong>anticiper les √©ventualit√©s</strong>  est l‚Äôobjectif : on ne sait jamais quand quelqu‚Äôun vous demandera le Wi-Fi ‚Äì autant que ce soit un r√©seau distinct brid√©.</p>
<h2 id="conclusion-vers-un-homelab-segmente-securise-et-evolutif"><strong>Conclusion : Vers un homelab segment√©, s√©curis√© et √©volutif</strong><a class="headerlink" href="#conclusion-vers-un-homelab-segmente-securise-et-evolutif" title="Permanent link">&para;</a></h2>
<p>En impl√©mentant une segmentation par VLAN dans votre homelab, vous posez les bases d‚Äôune architecture robuste o√π chaque cat√©gorie de dispositifs √©volue dans son  <strong>environnement contr√¥l√©</strong>. La configuration peut sembler complexe au d√©but (notamment la coordination entre routeur, switch et points d‚Äôacc√®s), mais le gain en s√©curit√© et en ma√Ætrise du r√©seau est consid√©rable pour un administrateur domestique. Vous avez d√©sormais un  <strong>plan de r√©seau d√©taill√©</strong>  distinguant les zones Prod, Lab, Domotique, Cam√©ras, Stockage, Sauvegarde, etc., avec des  <strong>passerelles (routeur)</strong>  g√©rant les communications entre ces zones de mani√®re filtr√©e.</p>
<p>N‚Äôh√©sitez pas √†  <strong>documenter votre topologie</strong>  (sch√©mas, tableaux d‚Äôadressage VLAN) et √† commenter vos r√®gles firewall pour vous y retrouver. √Ä mesure que votre homelab grandit, cette segmentation vous facilitera l‚Äôint√©gration de nouveaux services sans tout remettre en question : par exemple, ajouter un serveur PBX VoIP ? Cr√©ez un VLAN VoIP. Tester un cluster Kubernetes ? Peut-√™tre un VLAN ‚ÄúDev‚Äù s√©par√©. Votre r√©seau est d√©j√† pr√™t √† cloisonner ces ajouts.</p>
<p>En appliquant les bonnes pratiques (principe du moindre privil√®ge entre VLAN, isolation du management, utilisation d‚ÄôACL avanc√©es si besoin, etc.), vous rapprochez votre homelab d‚Äôun  <strong>r√©seau d‚Äôentreprise miniature</strong>  en termes de s√©rieux et de s√©curit√©. Enfin, v√©rifiez r√©guli√®rement vos r√®gles et appareils connect√©s ‚Äì la  <strong>discipline de segmentation</strong>n√©cessite de s‚Äôassurer qu‚Äôaucun appareil ne se retrouve par erreur dans le mauvais VLAN ou avec des droits inappropri√©s. Avec cette architecture VLAN bien pens√©e, votre homelab pourra h√©berger en toute confiance vos projets personnels, vos exercices de s√©curit√© et vos gadgets connect√©s, le tout  <strong>sans interf√©rences ni risques excessifs</strong>  entre eux.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.expand", "toc.integrate", "content.code.annotate", "search.highlight", "search.suggest"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>